// @ts-nocheck
const productData = {
    keyboard: [
        {
            name: "冰霜靜音鍵盤",
            price: "NT$1,990",
            description:
                "具備靜音紅軸與極簡霧面設計，搭配白色背光燈效，不僅適合辦公也非常適合夜間使用。鍵帽採用 PBT 材質，耐磨耐用。",
            src: "../image/product/keyboard/0.jpg",
        },
        {
            name: "烈焰機械鍵盤",
            price: "NT$2,490",
            description:
                "搭載熱插拔軸座與全區防鬼鍵設計，RGB 背光支援多種燈效模式。外殼為鋁合金上蓋，提供穩定的打字手感。",
            src: "../image/product/keyboard/1.jpg",
        },
        {
            name: "迷你60%鍵盤",
            price: "NT$1,690",
            description:
                "適合行動辦公與筆電使用者的精簡型鍵盤，具備必要的功能鍵，搭配藍牙與 USB Type-C 雙模連接，便攜性極高。",
            src: "../image/product/keyboard/2.jpg",
        },
        {
            name: "復古打字機鍵盤",
            price: "NT$2,290",
            description:
                "圓形鍵帽與金屬邊框呈現懷舊質感，兼具機械手感與視覺美感。內建藍牙功能，可同時連接筆電與平板。",
            src: "../image/product/keyboard/3.jpg",
        },
        {
            name: "多媒體快捷鍵盤",
            price: "NT$1,580",
            description:
                "配置完整多媒體快捷鍵與音量滾輪，搭配可拆式掌托與人體工學角度，提升長時間操作的舒適度。",
            src: "../image/product/keyboard/4.jpg",
        },
        {
            name: "無線藍牙鍵盤",
            price: "NT$2,180",
            description:
                "支援最多三台裝置快速切換，內建鋰電池可續航長達 30 天，鍵帽採剪刀腳設計，回饋感適中，適合日常使用。",
            src: "../image/product/keyboard/5.jpg",
        },
        {
            name: "靜音剪刀腳鍵盤",
            price: "NT$1,380",
            description:
                "超薄機身設計搭配靜音剪刀腳結構，提供極佳的敲擊體驗，適合圖書館、開放辦公空間等安靜環境使用。",
            src: "../image/product/keyboard/6.jpg",
        },
        {
            name: "RGB全彩機械鍵盤",
            price: "NT$2,880",
            description:
                "擁有 1680 萬色自訂背光與可編程巨集功能，五種軸體選擇可滿足不同使用者需求，專為電競設計。",
            src: "../image/product/keyboard/7.jpg",
        },
        {
            name: "人體工學分離式鍵盤",
            price: "NT$3,280",
            description:
                "符合人體工學的分離式佈局設計，降低手腕壓力與肩膀緊繃。適合長時間輸入工作者，如程式設計師與寫作人員。",
            src: "../image/product/keyboard/8.jpg",
        },
    ],
    mouse: [
        {
            name: "疾速無線滑鼠",
            price: "NT$1,490",
            description:
                "採用低延遲 2.4GHz 無線技術與高精度光學感應器，支援 DPI 五段切換，內建鋰電池可使用長達 45 小時。",
            src: "../image/product/mouse/0.jpg",
        },
        {
            name: "人體工學垂直滑鼠",
            price: "NT$1,280",
            description:
                "設計符合手腕自然角度，有效減少長時間使用造成的不適。附帶前進/返回快捷鍵，提升瀏覽效率。",
            src: "../image/product/mouse/1.jpg",
        },
        {
            name: "靜音無線滑鼠",
            price: "NT$890",
            description:
                "左右鍵皆採靜音設計，適合深夜工作或圖書館環境使用。輕巧外型搭配 USB 無線接收器，安裝即用。",
            src: "../image/product/mouse/2.jpg",
        },
        {
            name: "RGB 電競滑鼠",
            price: "NT$1,990",
            description:
                "具備 7 顆可編程按鍵與 DPI 即時切換，搭配 RGB 光效與人體工學握感，專為遊戲玩家打造。",
            src: "../image/product/mouse/3.jpg",
        },
        {
            name: "可折疊藍牙滑鼠",
            price: "NT$1,180",
            description:
                "輕巧可折疊設計方便攜帶，藍牙連線穩定，適合筆電使用者與商務人士，支援 Windows/macOS 雙平台。",
            src: "../image/product/mouse/4.jpg",
        },
    ],
    earphone: [
        {
            name: "藍牙運動耳機",
            price: "NT$1,290",
            description:
                "支援藍牙 5.2 與 IPX5 防水設計，適合運動與通勤使用，連線穩定且低延遲。",
            src: "../image/product/earphone/0.jpg",
        },
        {
            name: "降噪真無線耳機",
            price: "NT$2,880",
            description:
                "主動降噪搭配環境音模式，自適應音場調整，適合長時間配戴與沉浸式體驗。",
            src: "../image/product/earphone/1.jpg",
        },
        {
            name: "有線監聽耳機",
            price: "NT$1,580",
            description:
                "高解析單體與密閉式設計，重現清晰中高頻與穩定低音，適合混音與剪輯用途。",
            src: "../image/product/earphone/2.jpg",
        },
        {
            name: "電競耳罩式耳機",
            price: "NT$2,100",
            description:
                "環繞 7.1 聲道與舒適記憶耳墊設計，支援多平台，適用於激烈對戰與語音溝通。",
            src: "../image/product/earphone/3.jpg",
        },
        {
            name: "USB-C 入耳式耳機",
            price: "NT$690",
            description:
                "專為新型裝置打造的 USB-C 接頭耳機，支援高解析輸出與線控麥克風功能。",
            src: "../image/product/earphone/4.jpg",
        },
    ],
    speaker: [
        {
            name: "藍牙迷你喇叭",
            price: "NT$790",
            description:
                "便攜設計，支援藍牙 5.0，內建電池可連續播放 10 小時，適合戶外使用。",
            src: "../image/product/speaker/0.jpg",
        },
        {
            name: "雙聲道桌上型喇叭",
            price: "NT$1,650",
            description:
                "經典 2.0 聲道設計，提供清晰音質與強勁低頻，支援 3.5mm 輸入與音量調整旋鈕。",
            src: "../image/product/speaker/1.jpg",
        },
        {
            name: "RGB 電競喇叭",
            price: "NT$2,380",
            description:
                "炫彩 RGB 燈效，支援藍牙與 AUX 雙模輸入，搭配重低音單體增強遊戲臨場感。",
            src: "../image/product/speaker/2.jpg",
        },
    ],
    microphone: [
        {
            name: "USB 電容式麥克風",
            price: "NT$1,980",
            description:
                "專為直播與錄音設計，支援即插即用與多向收音模式，內建濾音罩有效減少噪音。",
            src: "../image/product/microphone/0.jpg",
        },
        {
            name: "動圈式手持麥克風",
            price: "NT$1,150",
            description:
                "經典設計搭配金屬外殼，適合卡拉 OK 與活動使用，耐摔且耐用。",
            src: "../image/product/microphone/1.jpg",
        },
        {
            name: "夾式無線麥克風",
            price: "NT$2,680",
            description:
                "雙發射器與單接收器設計，適合雙人訪談與戶外錄影，支援即時監聽與收音控制。",
            src: "../image/product/microphone/2.jpg",
        },
    ],
    mousepad: [
        {
            name: "加大型滑鼠墊",
            price: "NT$690",
            description:
                "覆蓋鍵盤與滑鼠區域，底部止滑材質搭配精細布面，提高滑動準確性與舒適度。",
            src: "../image/product/mousepad/0.jpg",
        },
        {
            name: "RGB 發光滑鼠墊",
            price: "NT$1,290",
            description:
                "支援多種燈效模式與觸控切換，表面細緻適合電競操作，搭配 USB 電源供應。",
            src: "../image/product/mousepad/1.jpg",
        },
        {
            name: "可水洗布面滑鼠墊",
            price: "NT$390",
            description:
                "抗污布面與天然橡膠底設計，支援機洗清潔，耐用度高，適合日常使用。",
            src: "../image/product/mousepad/2.jpg",
        },
    ],
    screen: [
        {
            name: "27 吋 IPS 螢幕",
            price: "NT$5,880",
            description:
                "Full HD 解析度搭配 75Hz 更新率，色彩準確並支援護眼濾藍光與不閃屏技術。",
            src: "../image/product/screen/0.jpg",
        },
        {
            name: "32 吋曲面電競螢幕",
            price: "NT$8,990",
            description:
                "WQHD 解析度、165Hz 更新率與 1ms 反應時間，支援 FreeSync/G-Sync 技術，提升遊戲體驗。",
            src: "../image/product/screen/1.jpg",
        },
    ],
    hub: [
        {
            name: "7 合 1 多功能 USB-C Hub",
            price: "NT$1,680",
            description:
                "包含 HDMI、USB 3.0、SD/TF 讀卡機與 PD 快充輸入，鋁合金外殼設計散熱優良，適用筆電與平板。",
            src: "../image/product/hub/0.jpg",
        },
    ],
};

let html = "";
let switchPageArea = document.querySelector(".switch-page-area");

const findChineseName = (selectProduct) => {
    const nameMap = {
        keyboard: "鍵盤",
        mouse: "滑鼠",
        earphone: "耳機",
        speaker: "喇叭",
        microphone: "麥克風",
        mousepad: "滑鼠墊",
        screen: "顯示器",
        hub: "擴充塢",
    };
    return nameMap[selectProduct] || "未知產品";
};

// 直接在HTML內植入onclick
const theProductPage = () => {
    html = `<div class="main-content">
                    <div class="bar">
                        <h3>產品專區</h3>
                        <nav class="breadcrumb">
                            <ul>
                                <li>
                                    <a href="../index.html">首頁</a>
                                </li>
                                <li>
                                    <a
                                        href="javascript:void(0);"
                                        onclick="changePage('product','product',null)"
                                        >產品專區</a
                                    >
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <div class="main-display">
                        <div
                            class="product-card"
                            data-product-name='keyboard'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/keyboard/0.jpg"
                                    alt="鍵盤"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>鍵盤</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='mouse'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/mouse/0.jpg"
                                    alt="滑鼠"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>滑鼠</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='earphone'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/earphone/0.jpg"
                                    alt="耳機"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>耳機</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='speaker'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/speaker/0.jpg"
                                    alt="喇叭"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>喇叭</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='microphone'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/microphone/0.jpg"
                                    alt="麥克風"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>麥克風</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='mousepad'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/mousepad/0.jpg"
                                    alt="滑鼠墊"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>滑鼠墊</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='screen'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/screen/0.jpg"
                                    alt="顯示器"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>顯示器</span>
                            </div>
                        </div>
                        <div
                            class="product-card"
                            data-product-name='hub'
                        >
                            <div class="product-card-img">
                                <img
                                    src="../image/product/hub/0.jpg"
                                    alt="擴充塢"
                                />
                            </div>
                            <div class="product-card-name">
                                <span>擴充塢</span>
                            </div>
                        </div>
                    </div>
                </div>`;
    switchPageArea.innerHTML = html;
    const appendProductPageClick = (e) => {
        // console.log(e.currentTarget.dataset.productName);
        changePage("selectProduct", e.currentTarget.dataset.productName, null);
    };
    let productCard = document.querySelectorAll(".product-card");
    productCard.forEach((item) => {
        item.removeEventListener("click", appendProductPageClick);
        item.addEventListener("click", appendProductPageClick);
    });
};

const product_to_selectProduct = (selectProduct, chineseName) => {
    html = "";
    html += `<div class="main-content">
                    <div class="bar">
                        <h3>產品專區</h3>
                        <nav class="breadcrumb">
                            <ul>
                                <li>
                                    <a href="../index.html">首頁</a>
                                </li>
                                <li>
                                    <a href="javascript:void(0);" onclick="changePage('product','product',null)">產品專區</a>
                                </li>
                                <li>
                                    <a href="javascript:void(0);">${chineseName}</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <div class="slelect_product">`;
    for (let i = 0; i < productData[selectProduct].length; i++) {
        html += `<div class="select-card">
                            <div class="select-card-img">
                                <img
                                    src="${productData[selectProduct][i].src}"
                                    alt="${productData[selectProduct][i].name}"
                                    loading="lazy"
                                />
                            </div>
                            <div class="select-card-content">
                                <div class="select-card-name">
                                    ${productData[selectProduct][i].name}
                                </div>
                                <div class="select-card-price">
                                    ${productData[selectProduct][i].price}
                                </div>
                                <div class="select-card-amount_button">
                                    <button class="minus">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="1" viewBox="0 0 13 1" fill="none">
                                            <path d="M0 1V0H13V1H0Z" fill="black"/>
                                        </svg>
                                    </button>
                                    <div class="amount">1</div>
                                    <button class="plus">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13" fill="none">
                                            <path d="M0 7V6H6V0H7V6H13V7H7V13H6V7H0Z" fill="black"/>
                                        </svg>
                                    </button>
                                </div>
                                <button class="select-card-add_to_cart">
                                    加入購物車
                                </button>
                            </div>
                    </div>`;
    }
    html += `</div>
                </div>
                `;
    window.scrollTo({
        top: 0,
        behavior: "auto",
    });
};

// 增加點擊"選擇產品"的頁面跳轉到"個別產品"的頁面的addeventListener
const selectProduct_to_targetProduct = (selectProduct, chineseName) => {
    let selectCards = document.querySelectorAll(".select-card");
    selectCards.forEach((card) => {
        let selectCardImg = card.querySelector(".select-card-img img");
        selectCardImg.addEventListener("click", function () {
            let target_product = productData[selectProduct].find(
                (product) => product.name === selectCardImg.alt
            );
            // console.log(
            //     productData[selectProduct],
            //     selectProduct,
            //     selectCardImg,
            //     selectCardImg.alt,
            //     target_product
            // );
            html = "";
            html += `<div
                            class="main-content"
                            style="display: flex; flex-direction: column;"
                        >
                            <div class="bar">
                                <h3>產品專區</h3>
                                <nav class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="../index.html">首頁</a>
                                        </li>
                                        <li>
                                            <a
                                                href="javascript:void(0);"
                                                onclick="changePage('product','product',null)"
                                                >產品專區</a
                                            >
                                        </li>
                                        <li>
                                            <a href="javascript:void(0);" onclick="changePage('selectProduct', '${selectProduct}',null)">${chineseName}</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                            <div class="individual-product">
                                <div class="individual-product-img">
                                    <img src="${target_product.src}" alt="${target_product.name}" />
                                </div>
                                <div class="individual-product-content">
                                    <div class="individual-product-content-title">
                                        ${target_product.name}
                                    </div>
                                    <div class="individual-product-content-text">
                                        <div class="description">
                                            ${target_product.description}
                                        </div>
                                        <div class="minus_and_plus-and-price">
                                            <div class="minus_and_plus">
                                                <button class="minus">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="13" height="1" viewBox="0 0 13 1" fill="none">
                                                        <path d="M0 1V0H13V1H0Z" fill="black"/>
                                                    </svg>
                                                </button>
                                                <div class="amount">1</div>
                                                <button class="plus">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 13 13" fill="none">
                                                        <path d="M0 7V6H6V0H7V6H13V7H7V13H6V7H0Z" fill="black"/>
                                                    </svg>
                                                </button>
                                            </div>
                                            <div class="price">${target_product.price}</div>
                                        </div>
                                    </div>
                                    <button class="add_to_cart">加入購物車</button>
                                </div>
                            </div>
                        </div>`;

            switchPageArea.innerHTML = html;
            html = "";
            window.scrollTo({
                top: 0,
                behavior: "auto",
            });
        });
    });
};

const changePage = (targetPage, selectProduct, targetProduct) => {
    // targetPage: 要跳轉的頁面
    // selectProduct: 選擇的產品類別
    // targetProduct: 詳細的目標商品頁
    if (!targetPage || targetPage === "product") {
        console.log("Product page selected");
        theProductPage();
    } else if (targetPage === "selectProduct") {
        let chineseName = "";
        chineseName = findChineseName(selectProduct);
        product_to_selectProduct(selectProduct, chineseName);
        switchPageArea.innerHTML = html;
        // 增加點擊"選擇產品"的頁面跳轉到"個別產品"的頁面的監聽程式碼
        selectProduct_to_targetProduct(selectProduct, chineseName);
    }
    html = "";
};

// 首頁點擊card後跳轉到對應的產品頁
let gotoPage = sessionStorage.getItem("gotoPage") || "";
if (gotoPage) {
    changePage("selectProduct", gotoPage, null);
    // 清除sessionStorage
    sessionStorage.removeItem("gotoPage");
} else {
    // 需要測試時，把html內要測試的區塊改為display: block，然後把下面這行註解
    changePage(gotoPage, "product", null);
}
document.addEventListener("touchstart", () => {}, true);
